@page "/engineering"
@page "/engineering/index"
@using MetromontCastLink.Shared.Models
@using MetromontCastLink.Client.Services
@inject NavigationManager Navigation
@inject IACCService ACCService

<PageTitle>Engineering - Metromont CastLink</PageTitle>

<div class="engineering-page">
    <div class="page-header">
        <div class="header-content">
            <div class="header-left">
                <div class="page-icon">
                    <span class="e-icons e-engineering"></span>
                </div>
                <div>
                    <h1>Engineering Center</h1>
                    <p>Design tools, calculators, and technical documentation for precast concrete engineering.</p>
                </div>
            </div>
            <div class="header-right">
                <ACCProjectSelector @bind-SelectedProjectId="@CurrentProjectId"
                                    ShowProjectInfo="false"
                                    Label="Current Project" />
            </div>
        </div>
    </div>

    <div class="tools-dashboard">
        <!-- Row 1: Design Tools -->
        <div class="tools-section">
            <h2 class="section-title">Design Tools</h2>
            <div class="tools-grid">
                <div class="tool-card active" @onclick="() => NavigateToTool('/engineering/calculator')">
                    <div class="tool-header">
                        <div class="tool-icon calculator">
                            <span>🧮</span>
                        </div>
                        <SfChip>
                            <ChipItems>
                                <ChipItem Text="Active" CssClass="status-active" />
                            </ChipItems>
                        </SfChip>
                    </div>
                    <h3>Design Calculator</h3>
                    <p>Engineering calculations for precast concrete elements with PCI code compliance.</p>
                    <div class="tool-features">
                        <span class="feature-tag">Beam Design</span>
                        <span class="feature-tag">Column Design</span>
                        <span class="feature-tag">Connection Design</span>
                    </div>
                    <div class="tool-action">
                        <span class="action-text">Open Calculator</span>
                        <span class="e-icons e-arrow-right"></span>
                    </div>
                </div>

                <div class="tool-card" @onclick="() => NavigateToTool('/engineering/viewer')">
                    <div class="tool-header">
                        <div class="tool-icon viewer">
                            <span>🏗️</span>
                        </div>
                        <SfChip>
                            <ChipItems>
                                <ChipItem Text="Beta" CssClass="status-beta" />
                            </ChipItems>
                        </SfChip>
                    </div>
                    <h3>3D Model Viewer</h3>
                    <p>View and analyze Revit models directly from ACC with element selection and properties.</p>
                    <div class="tool-features">
                        <span class="feature-tag">Forge Viewer</span>
                        <span class="feature-tag">Element Data</span>
                    </div>
                    <div class="tool-action">
                        <span class="action-text">Open Viewer</span>
                        <span class="e-icons e-arrow-right"></span>
                    </div>
                </div>

                <div class="tool-card" @onclick="() => NavigateToTool('/engineering/summary')">
                    <div class="tool-header">
                        <div class="tool-icon summary">
                            <span>📋</span>
                        </div>
                        <SfChip>
                            <ChipItems>
                                <ChipItem Text="Coming Soon" CssClass="status-upcoming" />
                            </ChipItems>
                        </SfChip>
                    </div>
                    <h3>Design Summary</h3>
                    <p>Generate comprehensive design summaries and reports for project documentation.</p>
                    <div class="tool-features">
                        <span class="feature-tag">Auto-Generate</span>
                        <span class="feature-tag">PDF Export</span>
                    </div>
                    <div class="tool-action">
                        <span class="action-text">Coming Soon</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Row 2: Resources -->
        <div class="tools-section">
            <h2 class="section-title">Resources & Documentation</h2>
            <div class="resource-grid">
                <div class="resource-card">
                    <div class="resource-icon">
                        <span class="e-icons e-book"></span>
                    </div>
                    <div class="resource-content">
                        <h4>PCI Design Manual</h4>
                        <p>Reference guide for precast concrete design standards and specifications.</p>
                    </div>
                </div>

                <div class="resource-card">
                    <div class="resource-icon">
                        <span class="e-icons e-settings"></span>
                    </div>
                    <div class="resource-content">
                        <h4>Standard Details</h4>
                        <p>Library of standard connection details and typical sections.</p>
                    </div>
                </div>

                <div class="resource-card">
                    <div class="resource-icon">
                        <span class="e-icons e-calculator"></span>
                    </div>
                    <div class="resource-content">
                        <h4>Load Tables</h4>
                        <p>Prestressed concrete member capacity tables and design aids.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    private string? CurrentProjectId;

    protected override async Task OnInitializedAsync()
    {
        var project = await ACCService.GetCurrentProjectAsync();
        CurrentProjectId = project?.Id;
    }

    private void NavigateToTool(string url)
    {
        Navigation.NavigateTo(url);
    }
}

@* Note: Move all CSS to Engineering.razor.css file *@